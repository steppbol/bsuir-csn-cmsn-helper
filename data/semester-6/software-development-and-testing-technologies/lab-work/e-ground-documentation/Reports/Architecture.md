# Архитектура
1. [Проектирование архитектуры](#type) <br>
  1.1 [Тип приложения](#type) <br>
  1.2 [Стратегия развертывания](#strategy) <br>
  1.3 [Используемые технологии](#technology) <br>
  1.4 [Реализация сквозной функциональности](#throught) <br>
  1.5 [Показатели качества](#quality) <br>
  1.6 [Диаграммы](#diagram) <br>
2. [Анализ архитектуры](#analysis) <br>
3. [Сравнение As Is и To Be, пути улучшения архитектуры](#compare) <br>  

<a name='type'></a>
## 1. Проектирование архитектуры 
### 1.1 Тип приложения
  Данное приложения будет создано основе на микросервисной архитектуры. Оно будет состоять из четырех модулей: <br>
- Customer Management - отвечает за операции над данными пользователей (логины, пароли, их сообщения). 
- Сatalog - CRUD операции над объявлениями
- Favourite Items - отдельный модуль для работы над избранными товарами
- Processor - модуль, взаимодействующих с пользователем и связывающий между собой три предыдущих.
Согласно микросервисной архитектуре для каждого модуля будет создана отдельная база данных.
Особенностью данной архитектуры является ее гибкость к изменениям, что позволяет, например, вносить какие-либо изменения в модуль, отвечающий за пользовательскую информацию, но все други модули буду работать как и прежде. Минусом данной архитектуры является ее сложность. В процессе написания программы возникла трудность для связывания сущностей в таблицах, которые находятся в разных базах данных.

<a name='strategy'></a>
### 1.2 Стартегия развертывания
  Для развертывания данного приложения будет применяться набор облачных сервисов, предоставляемых Amazon AWS. Для автоматизации развертывания будет применяться Docker. Какждый модуль будет помещен в отдельный снимок - исполняемый пакет, который будет содержать код, все необходимые зависимости и системные переменные. После того, как снимок будет запущен, то он становится отдельной средой выполнения - контейнером. Преимущество данного подхода заключается в том, приложения выполняется не на отдельной виртуальной машине, а в контейнере, который менее ресурсозатратный и запускается на любой ОС.
  
<a name='technology'></a>
### 1.3 Используемые технологии
  Для написания серверной части выбор пал на Spring Framework, поскольку он наиболее распространен и предоставляет очень широкий и удобный инструментарий, позволяющий в несколько строк кода и пару аннотаций создать с нуля полноценный REST веб сервис. Клиентская часть будет написана при помощи javascript фреймворка Angular.
  
<a name="throught"></a>
### 1.4 Реализация сквозной функциональности
  Система логгирования была написана путем вызова функций логгирования во всех участках кода. Для обработки ошибок, возникающих на уровне пакетов типа service реализованы отдельные контроллеры обработки ошибок, которые перехватывают пробрасываемые выше исключения и обрабатывают их. Безопасность приложения будет реализована с примененим Spring Security, что ограничит доступ пользователей к чужим аккаунтам.
  
<a name="quality"></a>
### 1.5 Показатели качества
  - Отключение какого-либо модуля должно оказывать минимальное влияние на другие. Например, при отключении Customer Management у пользователя должна оставаться возможность выполнять операции над объявлениями.
  - Доступность любой функциональности приложения в три клика.
  
<a name="diagrams"></a>
### 1.6 Диаграммы
  С диаграммами приложения можно ознакомиться по следующей [ссылке](https://github.com/steppbol/e-Ground/tree/master/e-ground-documentation/Diagrams)

<a name="analysis"></a>
## 2. Анализ архитектуры
  Архитектура каждого модуля представляет состоит из одинакового набора пакетов:
  - controller - Содержит внутри себя, контроллеры, отвечающие на запросы как со стороны пользователя, так и со стороны других приложения. Сюда так же входя advice контроллеры, задача которых заключается в обработке ошибок, пробрасываемых классами пакета service.
  - service - Внутри классов данного пакета содержится вся бизнес-логика приложения. CRUD операции над объявлениями и пользовательскими аккаунтами находятся именно здесь.
  - repository - В данном пакете находятся репозитории - интерфейсы, взаимодействующие непосредственно с базой данных.
  - validation - Присутствует только в модуле Customer Management, содержит класс, который проверяет наличие пользоаветелей с данными номерами и адресами электронной почты.
  - entity - Содержит классы, отображающие сущности и отношения между ними, с которыми работает данное приложение (аккаунт, объявление).
  - dto - Содержат классы, которые представляют сущности в удобном формате для клиентской части приложения.
  - configuration - Классы, выполняющие настройку фреймворка.
  - mapper - Классы, занимающиеся пребразованием сущностей в dto.
  - exception - Наши собственные исключения. В данном приложении данный пакет отсутствует, потому что полностью покрывается дргими, такими как, например, java.persistence.
  
  Не очень сложные приложения, построенные на базе Spring Framework, как правило, состоят из данных пакетов. Так же для них характерна иерархическая структура: ControllerClass содержит как миним один ServiceClass и MapperClass. ServiceClass как правило один или несколько Repository и ValidationClass или же MapperClass. 
  
<a name="compare"></a>
### 3. Сравнение As Is и To Be, пути улучшения архитектуры
  Архитектуры As Is и To Be получились почти одинаковыми, исключениями являются добавление пакета Validation в Сustomer Management, использование уже реализованных классов мапперов, в результате чего не было неоходимости создавать пакет классов mapper, а также отсутствия пакета со своими исключениями. Столь незначительные различия можно объяснить довольно простой системой сущностей и взаимосвязей между ними. 
  Пути улучшения архитектуры:
- вынесение в отдельный класс AccountDto личную информацию о пользователе - (EG-7198)
- dependency injection - (EG-4288)
- реализация builder - (EG-3842)
- непрерывная интеграция (Jenkins) - (EG-2655)
